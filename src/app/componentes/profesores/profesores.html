<div class="main-content">
    <h1>Profesores</h1>
    <form (ngSubmit)="editandoId ? guardarEdicion() : agregarProfesor()" class="profesor-form">
        <input type="text" placeholder="Nombre(s) del profesor" [(ngModel)]="nuevoProfesor.nombre" name="nombre"
            required />
        <input type="text" placeholder="Apellidos" [(ngModel)]="nuevoProfesor.apellidos" name="apellidos" required />
        <input type="email" placeholder="Email" [(ngModel)]="nuevoProfesor.email" name="email" required />

        <!-- Puede ser tutor -->
        <label>
            <input type="checkbox" [(ngModel)]="nuevoProfesor.can_be_tutor" name="can_be_tutor" /> Puede ser tutor
        </label>

        <!-- Puede ser tutor de grupo -->
        <label for="canBeTutorSelect">¿Puede ser tutor de grupo?</label>
        <select id="canBeTutorSelect" [(ngModel)]="nuevoProfesor.can_be_tutor" name="can_be_tutor">
            <option [ngValue]="false">No</option>
            <option [ngValue]="true">Sí</option>
        </select>

        <!-- Materias que puede impartir -->
        <label>Materias que puede impartir:</label>
        <ng-select [items]="materiasOpciones" [(ngModel)]="nuevoProfesor.materias" [multiple]="true" [searchable]="true"
            name="materias">
        </ng-select>

        <button class="btn-aceptar" type="submit">{{ editandoId ? 'Guardar' : 'Agregar' }}</button>
        <button type="button" *ngIf="editandoId" (click)="cancelarEdicion()">Cancelar</button>
    </form>

    <table>
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Apellidos</th>
                <th>Email</th>
                <th>Tutor de grupo</th>
                <th>Materias</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let profesor of profesores">
                <td>{{ profesor.nombre }}</td>
                <td>{{ profesor.apellidos }}</td>
                <td>{{ profesor.email }}</td>
                <td>{{ profesor.can_be_tutor ? 'Sí' : 'No' }}</td>
                <td>
                    <span *ngIf="profesor.materias && profesor.materias.length; else sinMaterias">
                        <span *ngFor="let materia of profesor.materias; let last = last">
                            {{ materia }}<span *ngIf="!last">, </span>
                        </span>
                    </span>
                    <ng-template #sinMaterias>Sin materias</ng-template>
                </td>
                <td>
                    <button (click)="editarProfesor(profesor)">Editar</button>
                    <button (click)="eliminarProfesor(profesor.id)">Eliminar</button>
                </td>
            </tr>
            <tr *ngIf="profesores.length === 0">
                <td colspan="6">No hay profesores registrados.</td>
            </tr>
        </tbody>
    </table>
</div>